{% extends 'base.html' %}
<!-- jQuery and jQuery UI CDN (add before </body>) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">

<script>
$(function() {
    $("#id_crime_type").autocomplete({
        source: "{% url 'crime_autocomplete' %}",
        minLength: 1
    });
});
</script>

{% block content %}
<style>
    .form-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        max-width: 800px;
        margin: 0 auto;
    }

    form{
        color: black;
    }

    .form-group {
        display: flex;
        flex-direction: column;
    }

    label {
        margin-bottom: 5px;
        font-weight: bold;
    }

    input, select, textarea {
        padding: 8px;
        border-radius: 4px;
        border: 1px solid #ccc;
    }

    button {
        margin: 0 10px;
        padding: 8px 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        background-color: #007bff;
        color: white;
    }

    button:hover {
        background-color: #0056b3;
    }
    .ctn{
        background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
        color: #fff;
        padding: 30px 0;
        margin-bottom: 30px;
    }
    @media (max-width:768px) {
        .ctn{
            padding: 30px;
        }
    }
</style>
<div class="ctn">
    <h2 class="text-center pb-3">Criminal Registration Form</h2>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}

        <button type="submit" name="register">Register</button>
        <button type="reset">Reset</button>
        <a href="{% url 'home' %}"><button type="button">Cancel</button></a>
    </form>
    {% endblock %}

    <div class="form-container">
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="form-group">
                {{ form.full_name.label_tag }}
                {{ form.full_name }}
            </div>

            <div class="form-group">
                {{ form.criminal_id_number.label_tag }}
                {{ form.criminal_id_number }}
            </div>

            <div class="form-group">
                {{ form.date_of_birth.label_tag }}
                {{ form.date_of_birth }}
            </div>

            <div class="form-group">
                {{ form.gender.label_tag }}
                {{ form.gender }}
            </div>

            <div class="form-group">
            <label for="crime-type">Crime Type (Select or Enter New)</label>
            <input type="text" name="crime_type_input" id="crime-type" list="crime-type-list" class="form-control" required>
            <datalist id="crime-type-list">
                {% for crime in crime_catalog %}
                <option value="{{ crime.name }}"></option>
                {% endfor %}
                </datalist>
            </div>


            <div class="form-group">
                {{ form.address.label_tag }}
                {{ form.address }}
            </div>

            <div class="form-group">
                {{ form.phone_number.label_tag }}
                {{ form.phone_number }}
            </div>

            <div class="form-group">
                {{ form.email.label_tag }}
                {{ form.email }}
            </div>

            <div class="form-group">
                {{ form.photograph.label_tag }}
                {{ form.photograph }}
            </div>

            <div class="form-group">
                {{ form.date_of_conviction.label_tag }}
                {{ form.date_of_conviction }}
            </div>

            <div class="form-group">
                {{ form.sentence_details.label_tag }}
                {{ form.sentence_details }}
            </div>

            <div class="form-group">
                {{ form.fingerprint.label_tag }}
                {{ form.fingerprint }}
            </div>

            <div class="form-group" style="grid-column: 1 / span 2;">
                {{ form.known_associates.label_tag }}
                {{ form.known_associates }}
            </div>
            
            <div class="form-group" style="display: flex; text-align: center;">
                <button type="submit" name="register">Register</button>
                <button type="reset">Reset</button>
                <a href="{% url 'home' %}"><button type="button">Cancel</button></a>
            </div>
        </form>
    </div>



    <div class="form-group">
        {{ form.photograph.label_tag }}
        {{ form.photograph }}
        <img id="photo-preview" src="#" alt="Photo Preview" style="display:none; max-width:200px; margin-top:10px;">
    </div>

    <div class="form-group">
        {{ form.fingerprint.label_tag }}
        {{ form.fingerprint }}
        <img id="fingerprint-preview" src="#" alt="Fingerprint Preview" style="display:none; max-width:200px; margin-top:10px;">
    </div>
</div>


<script>
    // Photo Preview
    document.getElementById('id_photograph').addEventListener('change', function (event) {
        let photo = document.getElementById('photo-preview');
        photo.style.display = 'block';
        photo.src = URL.createObjectURL(event.target.files[0]);
    });

    // Fingerprint Preview
    document.getElementById('id_fingerprint').addEventListener('change', function (event) {
        let fingerprint = document.getElementById('fingerprint-preview');
        fingerprint.style.display = 'block';
        fingerprint.src = URL.createObjectURL(event.target.files[0]);
    });
</script>
